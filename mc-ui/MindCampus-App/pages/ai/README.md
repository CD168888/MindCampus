# AI 对话功能

## 功能概述

AI 对话功能是 MindCampus 应用的核心功能之一，为用户提供智能化的心理健康咨询和问题解答服务。

## 功能特点

### 1. 实时对话
- 支持实时文字对话
- 流式输出，提供更好的交互体验
- 支持多轮对话，上下文连贯

### 2. 历史记录
- 自动保存对话历史
- 支持查看和加载历史对话
- 支持重命名对话标题
- 支持删除历史对话

### 3. 文件上传
- 支持上传图片、PDF、Word、Excel等多种格式文件
- 最多支持同时上传5个文件
- 实时预览已选文件

### 4. 美观界面
- 采用现代化设计风格
- 渐变色背景，与首页风格保持一致
- 流畅的动画效果
- 响应式布局，适配各种屏幕

## 技术实现

### 页面结构

```
pages/ai/
  ├── chat.vue          # AI对话页面
  ├── ai.js             # 工具函数
  └── README.md         # 说明文档
```

### 核心组件

1. **custom-nav-bar** - 自定义导航栏
   - 支持自定义标题、左侧和右侧内容
   - 适配状态栏高度
   - 支持返回和历史记录按钮

2. **聊天区域**
   - 消息列表展示
   - 区分用户消息和AI消息
   - 支持附件展示
   - 自动滚动到最新消息

3. **输入区域**
   - 自适应高度的文本输入框
   - 文件上传按钮
   - 发送按钮（输入内容后高亮）

4. **历史对话抽屉**
   - 侧边栏展示历史对话列表
   - 支持新建对话
   - 支持编辑和删除操作

### API接口（模拟）

目前使用模拟数据实现，包括：

1. **getChatHistory** - 获取历史对话列表
2. **getChatMessages** - 获取对话消息列表
3. **sendChatMessage** - 发送消息（支持流式响应）
4. **deleteChat** - 删除对话
5. **renameChat** - 重命名对话

### 工具函数

- `generateUUID()` - 生成唯一标识符
- `formatTime()` - 格式化时间显示
- `scrollToBottom()` - 滚动到底部
- `onInputFocus()` - 输入框聚焦处理
- `onInputBlur()` - 输入框失焦处理
- `adjustHeight()` - 调整输入框高度
- `goBack()` - 返回上一页

## 样式设计

### 配色方案

- **主色调**: 绿色渐变 (#10b981 → #1677FF)
- **用户消息**: 绿蓝渐变背景
- **AI消息**: 白色背景
- **背景**: 柔和渐变 (#F9F9F9 → #FFFFFF)

### 设计特点

- **玻璃态设计**: 使用 backdrop-filter 实现毛玻璃效果
- **微妙渐变**: 使用低透明度渐变，避免过于花哨
- **柔和阴影**: 使用多层阴影增强层次感
- **流畅动画**: 使用 cubic-bezier 缓动函数

## TabBar 配置

AI 功能已添加到 TabBar，替代原工作台位置：

```json
{
  "pagePath": "pages/ai/chat",
  "iconPath": "static/images/tabbar/work.png",
  "selectedIconPath": "static/images/tabbar/work_.png",
  "text": "AI"
}
```

注意：工作台页面仍然保留，但不在 TabBar 中显示。

## 使用方式

1. 点击底部导航栏的"AI"按钮进入对话页面
2. 在输入框中输入问题
3. 点击发送按钮或按键盘确认键发送消息
4. 查看AI的回复（模拟流式输出）
5. 可以点击右上角按钮查看历史对话

## 后续开发建议

1. **接入真实AI接口**
   - 替换 `api/chat.js` 中的模拟实现
   - 接入后端AI服务（如阿里云百炼）
   
2. **功能增强**
   - 支持语音输入
   - 支持图片识别
   - 支持更多文件类型
   - 添加表情包支持
   
3. **性能优化**
   - 消息列表虚拟滚动
   - 图片懒加载
   - 缓存优化
   
4. **用户体验**
   - 添加消息重发功能
   - 添加消息复制功能
   - 添加快捷回复
   - 添加AI人格设置

## 开发者说明

### 依赖组件

- `uni-icons` - 图标组件
- `custom-nav-bar` - 自定义导航栏组件

### 样式依赖

- `@/static/scss/theme.scss` - 主题样式文件

### 系统工具

- `@/utils/system.js` - 系统相关工具函数

## 更新日志

### v1.0.0 (2025-11-10)
- ✅ 初始版本发布
- ✅ 实现基础对话功能
- ✅ 实现历史记录管理
- ✅ 实现文件上传预览
- ✅ 采用模拟数据实现
- ✅ 完成UI设计和动画效果

